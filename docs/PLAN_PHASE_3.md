# PHASE 3: Storage + API

> **Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¿Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ´Ğ°Ñ‡ Ğ´Ğ»Ñ Ğ¤Ğ°Ğ·Ñ‹ 3**  
> Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² Ğ² Ğ‘Ğ” Ğ¸ API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸

**Ğ’ĞµÑ€ÑĞ¸Ñ:** 1.0  
**Ğ”Ğ°Ñ‚Ğ°:** 2026-02-06  
**ĞÑ€Ğ¸ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ¾Ñ‡Ğ½Ñ‹Ğ¹ ÑÑ€Ğ¾Ğº:** 3-5 Ğ´Ğ½ĞµĞ¹  
**ĞŸÑ€ĞµĞ´ÑƒÑĞ»Ğ¾Ğ²Ğ¸Ğµ:** Ğ¤Ğ°Ğ·Ğ° 2 Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ° (Plugin System Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚)

---

## Ğ¡Ğ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ñ‹

| Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ |
|----------|----------|--------|
| [ARCHITECTURE_BLUEPRINT.md](ARCHITECTURE_BLUEPRINT.md) | Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹ | âœ… ĞĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½ |
| [UPGRADE_TASKS.md](UPGRADE_TASKS.md) | Ğ”ĞµĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ²ÑĞµÑ… Ğ·Ğ°Ğ´Ğ°Ñ‡ | âœ… ĞĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½ |
| [PLAN_PHASE_0_1.md](PLAN_PHASE_0_1.md) | Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¤Ğ°Ğ·Ñ‹ 0-1 | âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ |
| [PLAN_PHASE_2.md](PLAN_PHASE_2.md) | Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¤Ğ°Ğ·Ñ‹ 2 | âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ |
| [PLAN_PHASE_3.md](PLAN_PHASE_3.md) | Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¤Ğ°Ğ·Ñ‹ 3 (ÑÑ‚Ğ¾Ñ‚ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚) | âœ… ĞĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½ |
| [PLAN_PHASE_4.md](PLAN_PHASE_4.md) | Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ»Ğ°Ğ½ Ğ¤Ğ°Ğ·Ñ‹ 4 (ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ) | âœ… ĞĞºÑ‚ÑƒĞ°Ğ»ĞµĞ½ |

### Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚Ğ°

| Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|----------|----------|
| [CURRENT_IMPLEMENTATION.md](CURRENT_IMPLEMENTATION.md) | Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ |
| [APP_DESCRIPTION_AND_API.md](APP_DESCRIPTION_AND_API.md) | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¸ API |

---

## ĞĞ°Ğ²Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ñ„Ğ°Ğ·Ğ°Ğ¼

| Ğ¤Ğ°Ğ·Ğ° | Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ |
|------|----------|----------|--------|
| 0-1 | [PLAN_PHASE_0_1.md](PLAN_PHASE_0_1.md) | Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ + Tool-Calling | âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ |
| 2 | [PLAN_PHASE_2.md](PLAN_PHASE_2.md) | Plugin System | âœ… Ğ—Ğ°Ğ²ĞµÑ€ÑˆÑ‘Ğ½ |
| 3 | **[PLAN_PHASE_3.md](PLAN_PHASE_3.md)** | Storage + API | ğŸ“ Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ |
| 4 | [PLAN_PHASE_4.md](PLAN_PHASE_4.md) | ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ | âœ… Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ |
| 5 | [PLAN_PHASE_5.md](PLAN_PHASE_5.md) | ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ñ‹ | ğŸ“‹ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ |
| 6 | [PLAN_PHASE_6.md](PLAN_PHASE_6.md) | Worklog Checker | ğŸ“‹ ĞŸĞ»Ğ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ |

---

## ĞĞ±Ñ‰Ğ°Ñ Ñ†ĞµĞ»ÑŒ Ğ¤Ğ°Ğ·Ñ‹ 3

**Ğ‘Ñ‹Ğ»Ğ¾ (Ğ¿Ğ¾ÑĞ»Ğµ Ğ¤Ğ°Ğ·Ñ‹ 2):** Plugin System Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚, Ğ½Ğ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² Ğ½Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ. ĞŸÑ€Ğ¸ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞºĞµ Ğ²ÑÑ‘ ÑĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµÑ‚ÑÑ.

**Ğ¡Ñ‚Ğ°Ğ»Ğ¾:** ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² (enabled/disabled, credentials, Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹) ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ² Ğ‘Ğ”. Ğ•ÑÑ‚ÑŒ API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ğ¸ Ğ¸Ñ… Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ğ¼Ğ¸.

**Ğ’Ğ°Ğ¶Ğ½Ğ¾:** 
- Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñƒ (SQLite, encryption.py)
- API Ğ·Ğ°Ñ‰Ğ¸Ñ‰Ñ‘Ğ½ X-Admin-Key (ĞºĞ°Ğº ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹)
- Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ ÑˆĞ¸Ñ„Ñ€ÑƒÑÑ‚ÑÑ (Fernet, ĞºĞ°Ğº Telegram/LLM Ñ‚Ğ¾ĞºĞµĞ½Ñ‹)

---

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¤Ğ°Ğ·Ñ‹ 3

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                             â”‚
â”‚  Admin Panel (Ğ¤Ğ°Ğ·Ğ° 4)                                                       â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â”‚  HTTP                                                               â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  Admin API (FastAPI)                                                    â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚  Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹:                                                  â”‚
â”‚  â”‚  â”œâ”€â”€ /api/settings/telegram/*                                          â”‚
â”‚  â”‚  â”œâ”€â”€ /api/settings/llm/*                                               â”‚
â”‚  â”‚  â””â”€â”€ /api/service-admins/*                                             â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚  ĞĞ¾Ğ²Ñ‹Ğµ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹:                              [Ğ¤ĞĞ—Ğ 3]                   â”‚
â”‚  â”‚  â”œâ”€â”€ /api/tools/*          â† tools_router.py                           â”‚
â”‚  â”‚  â””â”€â”€ /api/plugins/*        â† plugins_router.py                         â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚       â”‚                               â”‚
â”‚       â”‚                               â”‚
â”‚       â–¼                               â–¼
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  Tools Repository â”‚      â”‚  Plugin Settings Manager                  â”‚
â”‚  â”‚                   â”‚      â”‚  (tools/settings_manager.py)              â”‚
â”‚  â”‚  â€¢ CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸  â”‚â—„â”€â”€â”€â”€â–ºâ”‚                                           â”‚
â”‚  â”‚  â€¢ Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ     â”‚      â”‚  â€¢ get_settings()                         â”‚
â”‚  â”‚                   â”‚      â”‚  â€¢ save_settings()                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â€¢ validate_settings()                    â”‚
â”‚       â”‚                      â”‚  â€¢ sync_with_registry()                   â”‚
â”‚       â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚       â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚  SQLite           â”‚               â”‚
â”‚  â”‚                   â”‚               â–¼
â”‚  â”‚  tool_settings    â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  â”œâ”€â”€ tool_name    â”‚      â”‚  Tool Registry (Ğ¸Ğ· Ğ¤Ğ°Ğ·Ñ‹ 2)                â”‚
â”‚  â”‚  â”œâ”€â”€ plugin_id    â”‚      â”‚                                           â”‚
â”‚  â”‚  â”œâ”€â”€ enabled      â”‚â—„â”€â”€â”€â”€â–ºâ”‚  â€¢ Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ enabled ÑÑ‚Ğ°Ñ‚ÑƒÑĞ¾Ğ²        â”‚
â”‚  â”‚  â”œâ”€â”€ settings_jsonâ”‚      â”‚  â€¢ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ schema Ğ´Ğ»Ñ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸        â”‚
â”‚  â”‚  â””â”€â”€ updated_at   â”‚      â”‚                                           â”‚
â”‚  â”‚                   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ĞĞ¾Ğ²Ñ‹Ğµ/Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµĞ¼Ñ‹Ğµ Ñ„Ğ°Ğ¹Ğ»Ñ‹

```
LO_TG_BOT/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ db.py                   # [Ğ ĞĞ¡Ğ¨Ğ˜Ğ Ğ•ĞĞ˜Ğ•] Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ToolSettingsModel
â”‚   â”œâ”€â”€ tools_repository.py     # [ĞĞĞ’Ğ«Ğ™] CRUD Ğ´Ğ»Ñ tool_settings
â”‚   â”œâ”€â”€ tools_router.py         # [ĞĞĞ’Ğ«Ğ™] API /api/tools/*
â”‚   â”œâ”€â”€ plugins_router.py       # [ĞĞĞ’Ğ«Ğ™] API /api/plugins/*
â”‚   â””â”€â”€ app.py                  # [Ğ ĞĞ¡Ğ¨Ğ˜Ğ Ğ•ĞĞ˜Ğ•] ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹, startup
â”‚
â”œâ”€â”€ tools/
â”‚   â””â”€â”€ settings_manager.py     # [Ğ ĞĞ¡Ğ¨Ğ˜Ğ Ğ•ĞĞ˜Ğ•] Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ‘Ğ”
â”‚
â””â”€â”€ tests/
    â”œâ”€â”€ test_tools_repository.py
    â”œâ”€â”€ test_tools_router.py
    â””â”€â”€ test_plugins_router.py
```

---

# Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ¸ Ğ¤Ğ°Ğ·Ñ‹ 3

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.1: ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… ToolSettingsModel

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ SQLAlchemy Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ»Ñ Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ² ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ÑƒÑ Ğ‘Ğ”.

### Ğ¤Ğ°Ğ¹Ğ»: api/db.py (Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ)

### ĞœĞ¾Ğ´ĞµĞ»ÑŒ ToolSettingsModel

```python
class ToolSettingsModel(Base):
    """
    ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°/Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    
    Ğ¥Ñ€Ğ°Ğ½Ğ¸Ñ‚:
    - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (enabled)
    - ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ° (settings_json) â€” Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹
    """
    __tablename__ = "tool_settings"
    
    # ĞŸĞµÑ€Ğ²Ğ¸Ñ‡Ğ½Ñ‹Ğ¹ ĞºĞ»ÑÑ‡ â€” Ğ¸Ğ¼Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°
    tool_name = Column(String, primary_key=True)
    
    # ID Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°-Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ° (Ğ´Ğ»Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¸)
    plugin_id = Column(String, nullable=False, index=True)
    
    # Ğ’ĞºĞ»ÑÑ‡Ñ‘Ğ½ Ğ»Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚
    enabled = Column(Boolean, default=False, nullable=False)
    
    # ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ² JSON (Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Fernet)
    # Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {"jira_url": "...", "jira_token": "..."}
    settings_json = Column(Text, nullable=True)
    
    # Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¼ĞµÑ‚ĞºĞ¸
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
```

### ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ

Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ (ĞºĞ°Ğº ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹):

```python
# Ğ’ init_db() Ğ¸Ğ»Ğ¸ create_tables()
Base.metadata.create_all(bind=engine)
```

**Ğ’Ğ°Ğ¶Ğ½Ğ¾:** Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ (telegram_settings, llm_settings, service_admins) Ğ½Ğµ Ğ·Ğ°Ñ‚Ñ€Ğ°Ğ³Ğ¸Ğ²Ğ°ÑÑ‚ÑÑ.

### Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹

```python
# Ğ˜Ğ½Ğ´ĞµĞºÑ Ğ´Ğ»Ñ Ğ±Ñ‹ÑÑ‚Ñ€Ğ¾Ğ³Ğ¾ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¿Ğ¾ plugin_id
Index('ix_tool_settings_plugin_id', ToolSettingsModel.plugin_id)
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° Ğ² api/db.py
- [ ] Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ñ‘Ñ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
- [ ] Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğµ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹ Ğ½Ğµ Ğ»Ğ¾Ğ¼Ğ°ÑÑ‚ÑÑ
- [ ] Ğ¢ĞµÑÑ‚ Ğ½Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ/Ñ‡Ñ‚ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.2: Tools Repository

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
Ğ¡Ğ»Ğ¾Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ° Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼ Ğ´Ğ»Ñ tool_settings. Ğ˜Ğ½ĞºĞ°Ğ¿ÑÑƒĞ»Ğ¸Ñ€ÑƒĞµÑ‚ CRUD Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¸ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ.

### Ğ¤Ğ°Ğ¹Ğ»: api/tools_repository.py (Ğ½Ğ¾Ğ²Ñ‹Ğ¹)

### Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸

#### Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ
```python
def get_tool_settings(tool_name: str) -> ToolSettingsModel | None:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ° Ğ¿Ğ¾ Ğ¸Ğ¼ĞµĞ½Ğ¸.
    
    Args:
        tool_name: Ğ˜Ğ¼Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°
        
    Returns:
        ĞœĞ¾Ğ´ĞµĞ»ÑŒ Ñ Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°Ğ¼Ğ¸ Ğ¸Ğ»Ğ¸ None
    """

def get_all_tool_settings() -> List[ToolSettingsModel]:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ²ÑĞµÑ… Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ².
    
    Returns:
        Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹ (Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹)
    """

def get_tool_settings_by_plugin(plugin_id: str) -> List[ToolSettingsModel]:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    """
```

#### Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ
```python
def save_tool_settings(
    tool_name: str,
    plugin_id: str,
    enabled: bool = False,
    settings: dict | None = None
) -> ToolSettingsModel:
    """
    Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ° (create or update).
    
    Args:
        tool_name: Ğ˜Ğ¼Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°
        plugin_id: ID Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°
        enabled: Ğ’ĞºĞ»ÑÑ‡Ñ‘Ğ½ Ğ»Ğ¸
        settings: Ğ¡Ğ»Ğ¾Ğ²Ğ°Ñ€ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº (Ğ±ÑƒĞ´ĞµÑ‚ Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½)
        
    Returns:
        Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ñ‘Ğ½Ğ½Ğ°Ñ Ğ¼Ğ¾Ğ´ĞµĞ»ÑŒ
    """

def update_tool_enabled(tool_name: str, enabled: bool) -> bool:
    """
    ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ ÑÑ‚Ğ°Ñ‚ÑƒÑ enabled.
    
    Returns:
        True ĞµÑĞ»Ğ¸ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾, False ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
    """

def update_tool_settings(tool_name: str, settings: dict) -> bool:
    """
    ĞĞ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ (Ğ±ĞµĞ· Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ enabled).
    
    Returns:
        True ĞµÑĞ»Ğ¸ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾, False ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
    """
```

#### Ğ£Ğ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ
```python
def delete_tool_settings(tool_name: str) -> bool:
    """
    Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°.
    
    Returns:
        True ĞµÑĞ»Ğ¸ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾, False ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾
    """

def delete_plugin_settings(plugin_id: str) -> int:
    """
    Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ²ÑĞµÑ… Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    
    Returns:
        ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹
    """
```

### Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ `api/encryption.py`:

```python
from api.encryption import encrypt_value, decrypt_value

def _encrypt_settings(settings: dict) -> str:
    """Ğ—Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ² JSON ÑÑ‚Ñ€Ğ¾ĞºÑƒ"""
    json_str = json.dumps(settings, ensure_ascii=False)
    return encrypt_value(json_str)

def _decrypt_settings(encrypted: str) -> dict:
    """Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· JSON ÑÑ‚Ñ€Ğ¾ĞºĞ¸"""
    json_str = decrypt_value(encrypted)
    return json.loads(json_str)
```

### ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ»Ñ API

```python
def mask_settings(
    settings: dict, 
    schema: List[PluginSettingDefinition]
) -> dict:
    """
    ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑĞµĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğµ Ğ¿Ğ¾Ğ»Ñ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ´Ğ°Ñ‡Ğ¸ Ğ² API.
    
    ĞŸĞ¾Ğ»Ñ Ñ type='password' Ğ¼Ğ°ÑĞºĞ¸Ñ€ÑƒÑÑ‚ÑÑ ĞºĞ°Ğº '***xxxxx' (Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 5 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²).
    
    Args:
        settings: Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸
        schema: Ğ¡Ñ…ĞµĞ¼Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ¸Ğ· plugin.yaml
        
    Returns:
        ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ñ Ğ·Ğ°Ğ¼Ğ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ°Ñ€Ğ¾Ğ»ÑĞ¼Ğ¸
    """
    
def _mask_value(value: str) -> str:
    """ĞœĞ°ÑĞºĞ¸Ñ€ÑƒĞµÑ‚ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ, Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑÑ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ 5 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²"""
    if not value or len(value) <= 5:
        return "***"
    return f"***{value[-5:]}"
```

### Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ ÑĞµÑÑĞ¸ÑĞ¼Ğ¸

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½ Ğ¸Ğ· ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞ³Ğ¾ ĞºĞ¾Ğ´Ğ°:

```python
from api.db import SessionLocal

def get_tool_settings(tool_name: str) -> ToolSettingsModel | None:
    with SessionLocal() as session:
        result = session.query(ToolSettingsModel).filter(
            ToolSettingsModel.tool_name == tool_name
        ).first()
        
        if result and result.settings_json:
            # Ğ Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ´ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚Ğ¾Ğ¼
            result._decrypted_settings = _decrypt_settings(result.settings_json)
        
        return result
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] Ğ’ÑĞµ CRUD Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ñ‹
- [ ] Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ (Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ÑÑ encryption.py)
- [ ] ĞœĞ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] Ğ¢ĞµÑÑ‚Ñ‹ Ğ½Ğ° Ğ²ÑĞµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
- [ ] Ğ¢ĞµÑÑ‚Ñ‹ Ğ½Ğ° ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ/Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²ĞºÑƒ

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.3: Plugin Settings Manager (Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ)

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
Ğ Ğ°ÑÑˆĞ¸Ñ€Ğ¸Ñ‚ÑŒ `tools/settings_manager.py` Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ‘Ğ” Ğ²Ğ¼ĞµÑÑ‚Ğ¾ Ğ·Ğ°Ğ³Ğ»ÑƒÑˆĞµĞº.

### Ğ¤Ğ°Ğ¹Ğ»: tools/settings_manager.py (Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ğ¤Ğ°Ğ·Ñ‹ 2)

### Ğ‘Ñ‹Ğ»Ğ¾ (Ğ¤Ğ°Ğ·Ğ° 2)

```python
def get_plugin_setting(plugin_id: str, key: str, default: Any = None) -> Any:
    # Ğ—Ğ°Ğ³Ğ»ÑƒÑˆĞºĞ° â€” Ğ²ÑĞµĞ³Ğ´Ğ° Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ default
    return default
```

### Ğ¡Ñ‚Ğ°Ğ»Ğ¾ (Ğ¤Ğ°Ğ·Ğ° 3)

```python
from api.tools_repository import get_tool_settings, save_tool_settings

def get_plugin_settings(plugin_id: str) -> dict:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ° Ğ¸Ğ· Ğ‘Ğ”.
    
    Args:
        plugin_id: ID Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°
        
    Returns:
        Ğ¡Ğ»Ğ¾Ğ²Ğ°Ñ€ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº Ğ¸Ğ»Ğ¸ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹ dict
    """
    # ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµĞ¼ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°
    # (Ğ²ÑĞµ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‚ Ğ¾Ğ±Ñ‰Ğ¸Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸)
    from tools import get_registry
    registry = get_registry()
    
    tools = registry.get_tools_by_plugin(plugin_id)
    if not tools:
        return {}
    
    tool_name = tools[0].name
    record = get_tool_settings(tool_name)
    
    if record and hasattr(record, '_decrypted_settings'):
        return record._decrypted_settings
    
    return {}


def get_plugin_setting(plugin_id: str, key: str, default: Any = None) -> Any:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½ÑƒÑ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºÑƒ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    """
    settings = get_plugin_settings(plugin_id)
    return settings.get(key, default)


def save_plugin_settings(plugin_id: str, settings: dict) -> None:
    """
    Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ´Ğ»Ñ Ğ²ÑĞµÑ… Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°.
    """
    from tools import get_registry
    registry = get_registry()
    
    tools = registry.get_tools_by_plugin(plugin_id)
    
    for tool in tools:
        save_tool_settings(
            tool_name=tool.name,
            plugin_id=plugin_id,
            enabled=tool.enabled,
            settings=settings
        )


def is_plugin_configured(plugin_id: str) -> bool:
    """
    ĞŸÑ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ²ÑĞµ Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ñ‹.
    """
    from tools import get_registry
    registry = get_registry()
    
    manifest = registry.get_plugin(plugin_id)
    if not manifest or not manifest.settings:
        return True  # ĞĞµÑ‚ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº â€” ÑÑ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½Ñ‹Ğ¼
    
    settings = get_plugin_settings(plugin_id)
    
    for setting_def in manifest.settings:
        if setting_def.required:
            value = settings.get(setting_def.key)
            if value is None or value == "":
                return False
    
    return True


def get_missing_settings(plugin_id: str) -> List[str]:
    """
    ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ½ĞµĞ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ½Ñ‹Ñ… Ğ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº.
    """
    from tools import get_registry
    registry = get_registry()
    
    manifest = registry.get_plugin(plugin_id)
    if not manifest or not manifest.settings:
        return []
    
    settings = get_plugin_settings(plugin_id)
    missing = []
    
    for setting_def in manifest.settings:
        if setting_def.required:
            value = settings.get(setting_def.key)
            if value is None or value == "":
                missing.append(setting_def.key)
    
    return missing


def validate_plugin_settings(settings: dict, schema: List) -> List[dict]:
    """
    Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ¾ ÑÑ…ĞµĞ¼Ğµ.
    
    Returns:
        Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº [{"field": "...", "error": "..."}] Ğ¸Ğ»Ğ¸ []
    """
    errors = []
    
    for setting_def in schema:
        key = setting_def.key
        value = settings.get(key)
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° required
        if setting_def.required and (value is None or value == ""):
            # ĞŸÑ€Ğ¾Ğ¿ÑƒÑĞºĞ°ĞµĞ¼ Ğ·Ğ°Ğ¼Ğ°ÑĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ğ¸
            if not (isinstance(value, str) and value.startswith("***")):
                errors.append({"field": key, "error": "Required field is empty"})
                continue
        
        # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‚Ğ¸Ğ¿Ğ°
        if value is not None and value != "":
            if setting_def.type == "number":
                if not isinstance(value, (int, float)):
                    try:
                        float(value)
                    except:
                        errors.append({"field": key, "error": "Must be a number"})
            
            elif setting_def.type == "boolean":
                if not isinstance(value, bool):
                    errors.append({"field": key, "error": "Must be true or false"})
    
    return errors
```

### Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ Registry

```python
async def sync_settings_with_registry() -> None:
    """
    Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ” Ñ Registry.
    Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ².
    """
    from tools import get_registry
    from api.tools_repository import get_all_tool_settings
    
    registry = get_registry()
    db_settings = get_all_tool_settings()
    
    for record in db_settings:
        tool = registry.get_tool(record.tool_name)
        if tool:
            if record.enabled:
                registry.enable_tool(record.tool_name)
            else:
                registry.disable_tool(record.tool_name)
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] get_plugin_settings() Ñ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ Ğ¸Ğ· Ğ‘Ğ”
- [ ] save_plugin_settings() Ğ¿Ğ¸ÑˆĞµÑ‚ Ğ² Ğ‘Ğ”
- [ ] is_plugin_configured() Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ required Ğ¿Ğ¾Ğ»Ñ
- [ ] validate_plugin_settings() Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ¸Ñ€ÑƒĞµÑ‚
- [ ] sync_settings_with_registry() Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] Ğ¢ĞµÑÑ‚Ñ‹

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.4: Tools Router (API)

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
REST API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸: ÑĞ¿Ğ¸ÑĞ¾Ğº, Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ/Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ, Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸.

### Ğ¤Ğ°Ğ¹Ğ»: api/tools_router.py (Ğ½Ğ¾Ğ²Ñ‹Ğ¹)

### Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹

---

#### GET /api/tools â€” Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² Ñ Ğ¸Ñ… ÑÑ‚Ğ°Ñ‚ÑƒÑĞ°Ğ¼Ğ¸.

**Response 200:**
```json
{
  "tools": [
    {
      "name": "calculate",
      "description": "Evaluates mathematical expression...",
      "plugin_id": "calculator",
      "plugin_name": "Calculator",
      "enabled": true,
      "needs_config": false,
      "has_settings": false
    },
    {
      "name": "check_worklogs",
      "description": "Checks employee worklogs...",
      "plugin_id": "worklog-checker",
      "plugin_name": "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ¾Ñ€ĞºĞ»Ğ¾Ğ³Ğ¾Ğ²",
      "enabled": false,
      "needs_config": true,
      "has_settings": true
    }
  ],
  "total": 2,
  "enabled_count": 1
}
```

---

#### GET /api/tools/{name} â€” Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¿Ğ¾Ğ»Ğ½ÑƒÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ± Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğµ.

**Response 200:**
```json
{
  "name": "check_worklogs",
  "description": "Checks employee worklogs for specified period",
  "plugin_id": "worklog-checker",
  "plugin_name": "ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²Ğ¾Ñ€ĞºĞ»Ğ¾Ğ³Ğ¾Ğ²",
  "plugin_version": "1.0.0",
  "enabled": false,
  "needs_config": true,
  "parameters": {
    "type": "object",
    "properties": {
      "employee": {"type": "string", "description": "Employee name"},
      "period": {"type": "string", "description": "Period (week, month)"}
    },
    "required": ["employee"]
  },
  "settings_schema": [
    {
      "key": "jira_url",
      "label": "Jira URL",
      "type": "string",
      "required": true,
      "description": "Base URL of Jira instance"
    },
    {
      "key": "jira_token",
      "label": "Jira API Token",
      "type": "password",
      "required": true
    }
  ],
  "current_settings": {
    "jira_url": "https://jira.company.com",
    "jira_token": "***abc12"
  },
  "missing_settings": ["tempo_token"]
}
```

**Response 404:**
```json
{
  "detail": "Tool 'unknown_tool' not found"
}
```

---

#### POST /api/tools/{name}/enable â€” Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚

**ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ:** Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚. ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ‡Ñ‚Ğ¾ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ñ‹.

**Response 200:**
```json
{
  "success": true,
  "message": "Tool 'calculate' enabled"
}
```

**Response 400 (Ğ½ÑƒĞ¶Ğ½Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°):**
```json
{
  "success": false,
  "message": "Tool 'check_worklogs' requires configuration",
  "missing_settings": ["jira_url", "jira_token", "tempo_token"]
}
```

---

#### POST /api/tools/{name}/disable â€” Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚

**Response 200:**
```json
{
  "success": true,
  "message": "Tool 'calculate' disabled"
}
```

---

#### GET /api/tools/{name}/settings â€” ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

**Response 200:**
```json
{
  "plugin_id": "worklog-checker",
  "settings": {
    "jira_url": "https://jira.company.com",
    "jira_token": "***abc12",
    "required_hours": 8
  },
  "schema": [...]
}
```

---

#### PUT /api/tools/{name}/settings â€” Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸

**Request:**
```json
{
  "settings": {
    "jira_url": "https://jira.company.com",
    "jira_token": "new-secret-token",
    "required_hours": 8
  }
}
```

**Response 200:**
```json
{
  "success": true,
  "message": "Settings saved"
}
```

**Response 400 (Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ğ¸):**
```json
{
  "success": false,
  "message": "Validation failed",
  "errors": [
    {"field": "jira_url", "error": "Required field is empty"},
    {"field": "required_hours", "error": "Must be a number"}
  ]
}
```

**ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ:** Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğµ Ñ type=password Ğ¿ĞµÑ€ĞµĞ´Ğ°Ğ½Ğ¾ ĞºĞ°Ğº `"***..."` (Ğ¼Ğ°ÑĞºĞ°), Ğ¾Ğ½Ğ¾ Ğ½Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ÑÑ.

---

#### POST /api/tools/{name}/test â€” Ğ¢ĞµÑÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ

**Response 200:**
```json
{
  "success": true,
  "message": "Connection successful",
  "details": {
    "jira": "OK",
    "tempo": "OK"
  }
}
```

**Response 400 (Ğ½Ğµ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ):**
```json
{
  "success": false,
  "message": "Tool 'calculate' does not support connection testing"
}
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] GET /api/tools Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] GET /api/tools/{name} Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] POST /api/tools/{name}/enable Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] POST /api/tools/{name}/disable Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] GET /api/tools/{name}/settings Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] PUT /api/tools/{name}/settings Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] POST /api/tools/{name}/test Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] ĞĞ²Ñ‚Ğ¾Ñ€Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ‡ĞµÑ€ĞµĞ· X-Admin-Key
- [ ] Swagger Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ
- [ ] Ğ¢ĞµÑÑ‚Ñ‹ Ğ½Ğ° Ğ²ÑĞµ ÑĞ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.5: Plugins Router (API)

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°Ğ¼Ğ¸: ÑĞ¿Ğ¸ÑĞ¾Ğº, Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°.

### Ğ¤Ğ°Ğ¹Ğ»: api/plugins_router.py (Ğ½Ğ¾Ğ²Ñ‹Ğ¹)

### Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚Ñ‹

---

#### GET /api/plugins â€” Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²

**Response 200:**
```json
{
  "plugins": [
    {
      "id": "calculator",
      "name": "Calculator",
      "version": "1.0.0",
      "description": "Mathematical expression evaluator",
      "tools_count": 1,
      "enabled_count": 1
    },
    {
      "id": "datetime-tools",
      "name": "Date & Time",
      "version": "1.0.0",
      "description": "Date and time utilities",
      "tools_count": 3,
      "enabled_count": 2
    }
  ],
  "total": 2
}
```

---

#### POST /api/plugins/reload â€” ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ñ‹

**Response 200:**
```json
{
  "success": true,
  "message": "Plugins reloaded",
  "loaded": ["calculator", "datetime-tools"],
  "failed": [],
  "total_tools": 4
}
```

---

#### POST /api/plugins/{id}/reload â€” ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½

**Response 200:**
```json
{
  "success": true,
  "message": "Plugin 'calculator' reloaded",
  "tools_count": 1
}
```

**Response 404:**
```json
{
  "detail": "Plugin 'unknown' not found"
}
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] GET /api/plugins Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] POST /api/plugins/reload Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] POST /api/plugins/{id}/reload Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ñ Ğ‘Ğ” Ğ¿Ğ¾ÑĞ»Ğµ reload
- [ ] Ğ¢ĞµÑÑ‚Ñ‹

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.6: Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² app.py

### ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ¾Ğ²Ñ‹Ğµ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹ Ğ¸ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºÑƒ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ.

### Ğ¤Ğ°Ğ¹Ğ»: api/app.py (Ñ€Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ)

### Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ

#### ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ğ¾Ğ²

```python
from api.tools_router import router as tools_router
from api.plugins_router import router as plugins_router

# ĞŸĞ¾ÑĞ»Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ñ€Ğ¾ÑƒÑ‚ĞµÑ€Ğ¾Ğ²
app.include_router(tools_router)
app.include_router(plugins_router)
```

#### Startup event

```python
@app.on_event("startup")
async def startup_event():
    # Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°...
    
    # ĞĞĞ’ĞĞ•: Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²
    from tools import load_all_plugins
    from tools.settings_manager import sync_settings_with_registry
    
    logger.info("Loading plugins...")
    result = await load_all_plugins()
    logger.info(f"Loaded {len(result.loaded)} plugins with {result.total_tools} tools")
    
    if result.failed:
        for error in result.failed:
            logger.error(f"Failed to load plugin: {error.plugin_path} - {error.error}")
    
    # Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµĞ¼ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¸Ğ· Ğ‘Ğ”
    await sync_settings_with_registry()
    logger.info("Plugin settings synchronized with database")
```

### ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸

```
app startup:
â”‚
â”œâ”€â”€ 1. Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ‘Ğ” (ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ)
â”‚   â””â”€â”€ create_tables()
â”‚
â”œâ”€â”€ 2. Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² (ĞĞĞ’ĞĞ•)
â”‚   â”œâ”€â”€ load_all_plugins()
â”‚   â””â”€â”€ ĞŸĞ»Ğ°Ğ³Ğ¸Ğ½Ñ‹ Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒÑÑ‚ÑÑ Ğ² Registry
â”‚
â”œâ”€â”€ 3. Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº (ĞĞĞ’ĞĞ•)
â”‚   â”œâ”€â”€ sync_settings_with_registry()
â”‚   â””â”€â”€ enabled ÑÑ‚Ğ°Ñ‚ÑƒÑÑ‹ Ğ¸Ğ· Ğ‘Ğ” â†’ Registry
â”‚
â”œâ”€â”€ 4. Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ° (ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰ĞµĞµ)
â”‚   â””â”€â”€ start_bot_subprocess()
â”‚
â””â”€â”€ 5. Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğº Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ñƒ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
```

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] Ğ Ğ¾ÑƒÑ‚ĞµÑ€Ñ‹ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ñ‹
- [ ] ĞŸĞ»Ğ°Ğ³Ğ¸Ğ½Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ÑÑ‚ÑÑ Ğ¿Ñ€Ğ¸ ÑÑ‚Ğ°Ñ€Ñ‚Ğµ
- [ ] ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€ÑƒÑÑ‚ÑÑ
- [ ] Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- [ ] Ğ¡ÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ğ½Ğµ ÑĞ»Ğ¾Ğ¼Ğ°Ğ½Ğ°

---

## Ğ—Ğ°Ğ´Ğ°Ñ‡Ğ° 3.7: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¤Ğ°Ğ·Ñ‹ 3

### Unit-Ñ‚ĞµÑÑ‚Ñ‹

#### tests/test_tools_repository.py
```
test_save_tool_settings_new
test_save_tool_settings_update
test_get_tool_settings
test_get_tool_settings_not_found
test_get_all_tool_settings
test_update_tool_enabled
test_delete_tool_settings
test_encryption_decryption
test_mask_settings
```

#### tests/test_settings_manager.py
```
test_get_plugin_settings
test_get_plugin_setting_with_default
test_save_plugin_settings
test_is_plugin_configured_true
test_is_plugin_configured_false
test_get_missing_settings
test_validate_plugin_settings
test_sync_settings_with_registry
```

#### tests/test_tools_router.py
```
test_list_tools
test_get_tool
test_get_tool_not_found
test_enable_tool
test_enable_tool_needs_config
test_disable_tool
test_get_settings
test_update_settings
test_update_settings_validation_error
test_update_settings_preserve_masked_passwords
test_test_connection
```

#### tests/test_plugins_router.py
```
test_list_plugins
test_reload_all_plugins
test_reload_one_plugin
test_reload_one_plugin_not_found
```

### Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ñ‡ĞµĞºĞ»Ğ¸ÑÑ‚)

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° API Ñ‡ĞµÑ€ĞµĞ· Swagger (/docs):**
- [ ] GET /api/tools â€” Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº
- [ ] GET /api/tools/calculate â€” Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ´ĞµÑ‚Ğ°Ğ»Ğ¸
- [ ] POST /api/tools/calculate/enable â€” Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚
- [ ] POST /api/tools/calculate/disable â€” Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ°ĞµÑ‚
- [ ] PUT /api/tools/{name}/settings â€” ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚
- [ ] GET /api/plugins â€” Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ÑĞ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ²
- [ ] POST /api/plugins/reload â€” Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¿ĞµÑ€ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚Ğ¸:**
- [ ] Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚ â†’ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ â†’ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ Ğ²ĞºĞ»ÑÑ‡Ñ‘Ğ½
- [ ] Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ â†’ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ â†’ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ Ñ‡Ñ‚Ğ¾ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**
- [ ] ĞŸĞ¾ÑĞ¼Ğ¾Ñ‚Ñ€ĞµÑ‚ÑŒ Ğ² Ğ‘Ğ” â€” settings_json Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½
- [ ] API Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ñ€Ğ°ÑÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ (Ñ Ğ¼Ğ°ÑĞºĞ¾Ğ¹ Ğ´Ğ»Ñ Ğ¿Ğ°Ñ€Ğ¾Ğ»ĞµĞ¹)

### ĞšÑ€Ğ¸Ñ‚ĞµÑ€Ğ¸Ğ¹ Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸
- [ ] Ğ’ÑĞµ unit-Ñ‚ĞµÑÑ‚Ñ‹ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚
- [ ] Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¹Ğ´ĞµĞ½Ğ¾
- [ ] ĞĞµÑ‚ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¹

---

## ĞŸĞ¾ÑĞ»ĞµĞ´Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ”Ğ•ĞĞ¬ 1: Storage                                                            â”‚
â”‚                                                                             â”‚
â”‚  Ğ£Ñ‚Ñ€Ğ¾:                                                                      â”‚
â”‚  â”œâ”€â”€ 3.1 ĞœĞ¾Ğ´ĞµĞ»ÑŒ ToolSettingsModel Ğ² db.py                                  â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹                                                 â”‚
â”‚                                                                             â”‚
â”‚  ĞŸĞ¾ÑĞ»Ğµ Ğ¾Ğ±ĞµĞ´Ğ°:                                                               â”‚
â”‚  â”œâ”€â”€ 3.2 Tools Repository                                                  â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚Ñ‹ CRUD Ğ¸ ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ”Ğ•ĞĞ¬ 2: Settings Manager + API (Ñ‡Ğ°ÑÑ‚ÑŒ 1)                                   â”‚
â”‚                                                                             â”‚
â”‚  Ğ£Ñ‚Ñ€Ğ¾:                                                                      â”‚
â”‚  â”œâ”€â”€ 3.3 Ğ Ğ°ÑÑˆĞ¸Ñ€ĞµĞ½Ğ¸Ğµ settings_manager.py                                    â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚Ñ‹ settings_manager                                                â”‚
â”‚                                                                             â”‚
â”‚  ĞŸĞ¾ÑĞ»Ğµ Ğ¾Ğ±ĞµĞ´Ğ°:                                                               â”‚
â”‚  â”œâ”€â”€ 3.4 Tools Router (GET /api/tools, GET /api/tools/{name})              â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚Ñ‹                                                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ”Ğ•ĞĞ¬ 3: API (Ñ‡Ğ°ÑÑ‚ÑŒ 2) + Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ                                        â”‚
â”‚                                                                             â”‚
â”‚  Ğ£Ñ‚Ñ€Ğ¾:                                                                      â”‚
â”‚  â”œâ”€â”€ 3.4 Tools Router (enable, disable, settings, test)                    â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚Ñ‹                                                                 â”‚
â”‚                                                                             â”‚
â”‚  ĞŸĞ¾ÑĞ»Ğµ Ğ¾Ğ±ĞµĞ´Ğ°:                                                               â”‚
â”‚  â”œâ”€â”€ 3.5 Plugins Router                                                    â”‚
â”‚  â”œâ”€â”€ 3.6 Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² app.py                                               â”‚
â”‚  â””â”€â”€ Ğ¢ĞµÑÑ‚Ñ‹                                                                 â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ”Ğ•ĞĞ¬ 4: Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ                                                      â”‚
â”‚                                                                             â”‚
â”‚  â”œâ”€â”€ 3.7 Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾ Ñ‡ĞµĞºĞ»Ğ¸ÑÑ‚Ñƒ                                   â”‚
â”‚  â”œâ”€â”€ Ğ˜ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ±Ğ°Ğ³Ğ¾Ğ²                                                     â”‚
â”‚  â””â”€â”€ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ API (Swagger)                                            â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢ Ğ¤ĞĞ—Ğ« 3                                                          â”‚
â”‚                                                                             â”‚
â”‚  âœ… ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑÑÑ‚ÑÑ Ğ² Ğ‘Ğ”                                    â”‚
â”‚  âœ… Ğ¡ĞµĞºÑ€ĞµÑ‚Ñ‹ Ğ·Ğ°ÑˆĞ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹                                                     â”‚
â”‚  âœ… API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚                              â”‚
â”‚  âœ… API Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ°Ğ¼Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚                                  â”‚
â”‚  âœ… ĞŸĞµÑ€ÑĞ¸ÑÑ‚ĞµĞ½Ñ‚Ğ½Ğ¾ÑÑ‚ÑŒ: Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿ĞµÑ€ĞµĞ¶Ğ¸Ğ²Ğ°ÑÑ‚ Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ¿ÑƒÑĞº                       â”‚
â”‚  âœ… Ğ“Ğ¾Ñ‚Ğ¾Ğ² Ğ±ÑĞºĞµĞ½Ğ´ Ğ´Ğ»Ñ Ğ¤Ğ°Ğ·Ñ‹ 4 (ĞĞ´Ğ¼Ğ¸Ğ½ĞºĞ° Ğ˜Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹)                          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## API Summary

### Tools Router (/api/tools)

| ĞœĞµÑ‚Ğ¾Ğ´ | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|----------|----------|
| GET | /api/tools | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ² |
| GET | /api/tools/{name} | Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ğ° |
| POST | /api/tools/{name}/enable | Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ |
| POST | /api/tools/{name}/disable | Ğ’Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ |
| GET | /api/tools/{name}/settings | ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ |
| PUT | /api/tools/{name}/settings | Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ |
| POST | /api/tools/{name}/test | Ğ¢ĞµÑÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ |

### Plugins Router (/api/plugins)

| ĞœĞµÑ‚Ğ¾Ğ´ | Ğ­Ğ½Ğ´Ğ¿Ğ¾Ğ¸Ğ½Ñ‚ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|-------|----------|----------|
| GET | /api/plugins | Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ğ¾Ğ² |
| POST | /api/plugins/reload | ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ²ÑĞµ |
| POST | /api/plugins/{id}/reload | ĞŸĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¾Ğ´Ğ¸Ğ½ |

---

## Ğ Ğ¸ÑĞºĞ¸ Ğ¸ Ğ¼Ğ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ğ¸

| Ğ Ğ¸ÑĞº | Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒ | Ğ’Ğ»Ğ¸ÑĞ½Ğ¸Ğµ | ĞœĞ¸Ñ‚Ğ¸Ğ³Ğ°Ñ†Ğ¸Ñ |
|------|-------------|---------|-----------|
| ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ‘Ğ” ÑĞ»Ğ¾Ğ¼Ğ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ | ĞĞ¸Ğ·ĞºĞ°Ñ | Ğ’Ñ‹ÑĞ¾ĞºĞ¾Ğµ | ĞĞ¾Ğ²Ğ°Ñ Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°, Ğ½Ğµ Ñ‚Ñ€Ğ¾Ğ³Ğ°ĞµĞ¼ ÑÑ‚Ğ°Ñ€Ñ‹Ğµ |
| Ğ¨Ğ¸Ñ„Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ½ĞµÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ | ĞĞ¸Ğ·ĞºĞ°Ñ | Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ | Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµĞ¼ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¹ encryption.py |
| Ğ“Ğ¾Ğ½ĞºĞ¸ Ğ¿Ñ€Ğ¸ Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ñ… | Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ | Ğ¡Ñ€ĞµĞ´Ğ½ĞµĞµ | Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ SQLAlchemy |

---

## Definition of Done Ğ´Ğ»Ñ Ğ¤Ğ°Ğ·Ñ‹ 3

- [ ] Ğ’ÑĞµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸ 3.1-3.7 Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ñ‹
- [ ] ĞœĞ¾Ğ´ĞµĞ»ÑŒ ToolSettingsModel ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ°
- [ ] Repository Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚
- [ ] Settings Manager Ğ¸Ğ½Ñ‚ĞµĞ³Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½ Ñ Ğ‘Ğ”
- [ ] Tools Router Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½
- [ ] Plugins Router Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½
- [ ] Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² app.py Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°
- [ ] Ğ’ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚
- [ ] Ğ ÑƒÑ‡Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ñ€Ğ¾Ğ¹Ğ´ĞµĞ½Ğ¾
- [ ] Swagger Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ°ĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ°
- [ ] ĞĞµÑ‚ Ñ€ĞµĞ³Ñ€ĞµÑÑĞ¸Ğ¹

---

## Ğ§Ñ‚Ğ¾ ĞĞ• Ğ²Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² Ğ¤Ğ°Ğ·Ñƒ 3

- âŒ UI Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞ¸ (Ğ¤Ğ°Ğ·Ğ° 4)
- âŒ Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ¿Ğ»Ğ°Ğ³Ğ¸Ğ½Ñ‹ (Ğ¤Ğ°Ğ·Ğ° 6)

---

## Ğ’ĞµÑ€ÑĞ¸Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°

| Ğ’ĞµÑ€ÑĞ¸Ñ | Ğ”Ğ°Ñ‚Ğ° | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ |
|--------|------|----------|
| 1.0 | 2026-02-06 | ĞŸĞµÑ€Ğ²Ğ°Ñ Ğ²ĞµÑ€ÑĞ¸Ñ Ğ¿Ğ»Ğ°Ğ½Ğ° Ğ¤Ğ°Ğ·Ñ‹ 3 |
