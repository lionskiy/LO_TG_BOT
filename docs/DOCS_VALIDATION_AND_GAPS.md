# Валидация документации docs/

**Дата:** 2026-02-07  
**Цель:** Проверка согласованности спецификаций (реализованных и плановых), выявление слабых мест и устранение упущений.

---

## 1. Роль документов

| Документ | Назначение |
|----------|------------|
| **TG_Project_Helper_v1.0.md** | Полная спецификация **реализованной** версии (v1.0): архитектура, API, установка, решение проблем. |
| **TG_Project_Helper_v1.0_QUICKSTART.md** | Быстрый старт и FAQ по **реализованной** версии. |
| **ARCHITECTURE_BLUEPRINT.md** | Целевая архитектура (плагины, tool-calling, инструменты). |
| **UPGRADE_TASKS.md** | Декомпозиция задач по фазам. |
| **PLAN_PHASE_0_1.md** … **PLAN_PHASE_6.md** | Детальные планы фаз развития (tool-calling, плагины, админка, Worklog Checker). |

---

## 2. Найденные проблемы и исправления

### 2.1 Устаревшие ссылки на несуществующие документы

**Проблема:** В ARCHITECTURE_BLUEPRINT, UPGRADE_TASKS и во всех PLAN_PHASE_* в блоке «Существующая документация проекта» указаны файлы, которых нет в репозитории:

- `CURRENT_IMPLEMENTATION.md`
- `APP_DESCRIPTION_AND_API.md`
- `LAUNCH_INSTRUCTIONS.md`

**Исправление:** Во всех этих документах блок «Существующая документация проекта» заменён на актуальные ссылки:

- **Текущая реализация (v1.0):** [TG_Project_Helper_v1.0.md](TG_Project_Helper_v1.0.md)
- **Быстрый старт и FAQ:** [TG_Project_Helper_v1.0_QUICKSTART.md](TG_Project_Helper_v1.0_QUICKSTART.md)

Таким образом, плановые документы явно опираются на реализованную спеку.

---

### 2.2 Несогласованность формата периода (Worklog Checker)

**Проблема:** Разный формат параметра `period` в разных документах:

- **ARCHITECTURE_BLUEPRINT:** `today, yesterday, week, month` или диапазон `YYYY-MM-DD:YYYY-MM-DD` (двоеточие).
- **PLAN_PHASE_6:** `this_week`, `last_week`, `this_month`, `last_month` или `YYYY-MM-DD/YYYY-MM-DD` (слэш).

**Исправление:** Принят единый формат (как в PLAN_PHASE_6):

- Предустановки: `this_week`, `last_week`, `this_month`, `last_month`.
- Диапазон дат: `YYYY-MM-DD/YYYY-MM-DD` (слэш).

В ARCHITECTURE_BLUEPRINT примеры и описания `period` приведены к этому формату.

---

### 2.3 Связь планов с текущим состоянием (v1.0)

**Проблема:** В ARCHITECTURE_BLUEPRINT и UPGRADE_TASKS не было явного указания, что «текущая реализация» — это TG Project Helper v1.0 и где её описание.

**Исправление:** В начале ARCHITECTURE_BLUEPRINT и UPGRADE_TASKS добавлена секция «Текущее состояние (v1.0)» со ссылками на TG_Project_Helper_v1.0.md и QUICKSTART. Это задаёт базовый уровень, от которого строятся фазы 0–6.

---

### 2.4 Фаза 5: предусловие и параллельность

**Ситуация:** В ARCHITECTURE_BLUEPRINT указано, что Фаза 5 (админка «Администраторы») может идти параллельно с 4 и 6, так как API уже есть. В PLAN_PHASE_5 предусловием указано завершение Фазы 4 (чтобы в меню был пункт «Администраторы»).

**Уточнение:** Оба утверждения согласованы: API администраторов реализован в v1.0, поэтому разработку UI (Фаза 5) можно начинать в любой момент. Зависимость от Фазы 4 нужна только для единой навигации: пункт меню «Администраторы» добавляется в Фазе 4 (см. PLAN_PHASE_4), в Фазе 5 заполняется контент. Если Фаза 5 делается раньше Фазы 4, пункт меню можно добавить в самой Фазе 5. В PLAN_PHASE_5 это отражено в примечании.

---

### 2.5 История диалога при tool-calling (Фаза 0–1)

**Потенциальный пробел:** Не было явно зафиксировано, что именно попадает в историю диалога при использовании инструментов (только финальный ответ или также сообщения assistant с tool_calls и tool results).

**Дополнение:** В PLAN_PHASE_0_1 в критерии готовности/описании добавлено: в историю диалога сохраняется **только финальный текстовый ответ** пользователю; промежуточные сообщения (assistant с tool_calls, tool results) в историю не пишутся. Это предотвращает раздувание контекста и расхождение форматов между провайдерами.

---

### 2.6 Миграции БД (Фаза 3)

**Потенциальный пробел:** В Фазе 3 добавляется таблица `tool_settings`. Не везде явно указано, как создаётся схема (при старте приложения или отдельные миграции).

**Рекомендация:** В PLAN_PHASE_3 уже зафиксировано: таблица `tool_settings` создаётся автоматически при старте приложения (`Base.metadata.create_all`), как и существующие таблицы. Дополнительные миграции не требуются. При необходимости в будущем можно ввести Alembic.

---

### 2.7 QUICKSTART: раздел «Администраторы» в админке

**Уточнение:** В QUICKSTART для добавления администратора указано «Через админ-панель: (если реализовано в UI)». В v1.0 UI для администраторов в админке не реализован (запланирован в Фазе 5). Добавлена одна строка: раздел «Администраторы» в админке планируется в Фазе 5 (см. PLAN_PHASE_5.md); до этого — только API/Swagger.

---

### 2.8 Версионирование и нумерация фаз

**Проверка:** Нумерация фаз единообразна во всех документах: 0–1, 2, 3, 4, 5, 6, 7+ (будущие плагины). Расхождений нет.

---

## 3. Рекомендации на будущее

1. **При завершении каждой фазы** обновлять TG_Project_Helper_v1.0.md (и при необходимости QUICKSTART), чтобы описание «текущей реализации» соответствовало коду (новые эндпоинты, разделы админки, плагины).
2. **Единый формат периодов:** при добавлении новых плагинов с временными интервалами использовать тот же формат, что и в Worklog Checker (`this_week`, `last_week`, диапазон `YYYY-MM-DD/YYYY-MM-DD`), если иное не обосновано.
3. **Тесты:** в планах фаз уже заложены критерии и тесты; при реализации следить, чтобы тесты не зависели от реальных внешних API (мокировать Jira/Tempo, LLM, Telegram где нужно).
4. **Таймзона для Worklog Checker:** в PLAN_PHASE_6 зафиксировать в спеках, по какой таймзоне считаются «рабочие дни» и границы периода (UTC или локальная, например Europe/Moscow), и придерживаться этого в реализации.

---

## 4. Чеклист согласованности (после правок)

- [x] Все плановые документы ссылаются на актуальную реализацию (TG_Project_Helper_v1.0, QUICKSTART).
- [x] Формат `period` для Worklog Checker унифицирован (this_week/last_week/this_month/last_month, YYYY-MM-DD/YYYY-MM-DD).
- [x] В BLUEPRINT и UPGRADE_TASKS есть явное «Текущее состояние (v1.0)».
- [x] Сохранение в историю при tool-calling явно описано в PLAN_PHASE_0_1.
- [x] В QUICKSTART уточнено про UI администраторов (Фаза 5).
- [x] Фаза 5 предусловие/параллельность согласованы с Фазой 4 (навигация).

---

**Версионирование документа**

| Версия | Дата | Описание |
|--------|------|----------|
| 1.0 | 2026-02-07 | Первая валидация, перечень исправлений и дополнений |
